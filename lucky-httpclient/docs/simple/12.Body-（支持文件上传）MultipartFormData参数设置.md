## ğŸ—ƒï¸ `multipart/form-data`å‚æ•°è®¾ç½®

---
`multipart/form-data` æ˜¯ä¸€ç§ç¼–ç ç±»å‹ï¼Œç”¨äºé€šè¿‡ HTTP è¯·æ±‚ä¸Šä¼ æ–‡ä»¶å’Œæ•°æ®ã€‚å½“ç”¨æˆ·é€šè¿‡ HTML è¡¨å•æäº¤æ•°æ®æ—¶ï¼Œå°¤å…¶æ˜¯åŒ…å«æ–‡ä»¶ä¸Šä¼ çš„è¡¨å•ï¼Œ`multipart/form-data` å°±æ˜¯å¸¸ç”¨çš„ç¼–ç æ ¼å¼ã€‚

### ç”¨é€”
`multipart/form-data` ä¸»è¦ç”¨äºå…è®¸ç”¨æˆ·é€šè¿‡ Web è¡¨å•ä¸Šä¼ æ–‡ä»¶ã€‚å®ƒå°†è¡¨å•æ•°æ®åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†å¯ä»¥åŒ…å«ä¸€ä¸ªå­—æ®µæˆ–ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ€ç»ˆè¿™äº›éƒ¨åˆ†ç»„åˆæˆä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ä½“ã€‚è¿™ç§æ ¼å¼å¯ä»¥ä¼ é€’äºŒè¿›åˆ¶æ–‡ä»¶ä»¥åŠå…¶ä»–ç±»å‹çš„æ•°æ®ï¼ˆå¦‚æ–‡æœ¬å­—æ®µï¼‰ã€‚

### å·¥ä½œåŸç†
å½“æµè§ˆå™¨é€šè¿‡ POST è¯·æ±‚å‘é€è¡¨å•æ—¶ï¼Œè¡¨å•ä¸­çš„æ¯ä¸ªå­—æ®µéƒ½åŒ…å«åœ¨ä¸€ä¸ªå¤šéƒ¨åˆ†çš„å†…å®¹ä¸­ï¼Œæ¯ä¸ªéƒ¨åˆ†çš„å†…å®¹é€šè¿‡ä¸€ä¸ªè¾¹ç•Œï¼ˆboundaryï¼‰åˆ†éš”å¼€æ¥ã€‚boundary æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ ‡è®°ç¬¦ï¼Œç¡®ä¿æ¯ä¸ªå­—æ®µçš„è¾¹ç•Œå’Œå†…å®¹æ˜¯ç‹¬ç«‹çš„ã€‚

### è¯·æ±‚æ ¼å¼
åœ¨ `multipart/form-data` è¯·æ±‚ä¸­ï¼Œæ•°æ®æŒ‰ä»¥ä¸‹æ ¼å¼åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼ˆæ¯éƒ¨åˆ†å‰åéƒ½æœ‰è¾¹ç•Œæ ‡è¯†ç¬¦ï¼‰ï¼š

- æ¯éƒ¨åˆ†çš„ Content-Disposition è¡¨ç¤ºè¯¥éƒ¨åˆ†çš„å†…å®¹ï¼ˆå­—æ®µåæˆ–æ–‡ä»¶åï¼‰ã€‚
- å¦‚æœæ˜¯æ–‡ä»¶éƒ¨åˆ†ï¼ŒContent-Type è¡¨ç¤ºæ–‡ä»¶çš„ MIME ç±»å‹ã€‚
- æ¯éƒ¨åˆ†ä¹‹é—´ç”¨ä¸€ä¸ªå”¯ä¸€çš„ boundary è¿›è¡Œåˆ†éš”ã€‚

### ç¤ºä¾‹ HTTP è¯·æ±‚ï¼ˆè¯·æ±‚ä½“ï¼‰
å‡è®¾æˆ‘ä»¬è¦æäº¤ä¸€ä¸ªæ–‡ä»¶å’Œä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œè¡¨å•æ•°æ®å¯èƒ½å¦‚ä¸‹ï¼š
```http request
POST /upload HTTP/1.1
Host: example.com
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Length: 475

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="username"

john_doe
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file1"; filename="example.txt"
Content-Type: text/plain

[æ–‡ä»¶å†…å®¹]
------WebKitFormBoundary7MA4YWxkTrZu0gW--
```

---
### #ä½¿ç”¨`@MultiData` + `@MultiFile`æ¥è¿›è¡Œå‚æ•°è®¾ç½®

- `@MultiData`: ç”¨äºæ ‡è¯†ä¸€ä¸ªæ–‡æœ¬å‚æ•°
- `@MultiFile`: ç”¨æ¥æ ‡è¯†ä¸€ä¸ªæ–‡ä»¶å‚æ•° 

`@MultiFile`æ³¨è§£æ”¯æŒçš„å‚æ•°ç±»å‹å¦‚ä¸‹ï¼š  
1. **æ— éœ€è®¾ç½®æ–‡ä»¶åçš„ç±»å‹ï¼Œå¦‚æœæ˜¯å¦‚ä¸‹ç±»å‹`fileName`å±æ€§å°†ä¼šå¤±æ•ˆ**  
- `File`ã€`File[]`ã€`Collection<File>`
- `Resource`ã€`Resource[]`ã€`Collection<Resource>`
- `MultipartFile`ã€`MultipartFile[]`ã€`Collection<MultipartFile>`
- `HttpFile`ã€`HttpFile[]`ã€`Collection<HttpFile>`
- `String`ã€`String[]`ã€`Collection<String>`ç±»å‹çš„èµ„æºå®šä½ç¬¦å·ï¼Œå‚ç…§`ResourceLoader#getResource(String)`  
  ä¾‹å¦‚ï¼š
  - http://www.baidu.com/img/bd_logo1.png
  - file:D:/test/test.txt
  - classpath:file/*.pdf
  
2. **å¿…é¡»è®¾ç½®æ–‡ä»¶åçš„ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®`fileName`å±æ€§å°†æŠ›å‡ºå¼‚å¸¸**
- `byte[]`ä»¥åŠä»–çš„`æ•°ç»„`å’Œ`é›†åˆç±»å‹`
- `Byte[]`ä»¥åŠä»–çš„`æ•°ç»„`å’Œ`é›†åˆç±»å‹`
- `InputStream`ä»¥åŠä»–çš„`æ•°ç»„`å’Œ`é›†åˆç±»å‹`  
æ³¨:
  
åœ¨ä½¿ç”¨ä»¥ä¸Šç±»å‹çš„æ•°ç»„æˆ–è€…é›†åˆæ—¶`fileName`å±æ€§ä¸­å¯ä»¥ä½¿ç”¨å ä½ç¬¦`{_index_}`ï¼Œ  
å®é™…ç”Ÿæˆçš„æ–‡ä»¶åä¸­ä¼šè¢«æ›¿æ¢ä¸ºæ•°ç»„æˆ–è€…é›†åˆçš„ä¸‹æ ‡ã€‚  


å…·ä½“ä½¿ç”¨çš„å®ä¾‹ä»£ç å¦‚ä¸‹ï¼š  

1. ã€çº¯æ–‡æœ¬çš„è¡¨å•ã€‘

```java
import com.luckyframework.httpclient.proxy.annotations.NotHttpParam;

/*
    ã€çº¯æ–‡æœ¬çš„è¡¨å•ã€‘
    text("Jack", 18, "jack@gmail.com")  
    
    -->
    
    POST http://localhost:8080/lucky/hello
    User-Agent: Lucky-HttpClient/3.0.1 (Java/1.8.0_432)
    Content-Type: multipart/form-data; boundary=LuckyBoundary

    --LuckyBoundary
    Content-Disposition: form-data; name="name"
    Content-Type: text/plain

    Jack
    --LuckyBoundary
    Content-Disposition: form-data; name="age"
    Content-Type: text/plain

    18
    --LuckyBoundary
    Content-Disposition: form-data; name="email"
    Content-Type: text/plain

    jack@gmail.com
    --LuckyBoundary--
      
 */
@Post("http://localhost:8080/multipartFormData")
String text(@MultiData String name, @MultiData Integer age, @MultiData String email);

// ä¸Šè¿°æ¥å£çš„ç®€åŒ–å†™æ³•
@MultiData
@Post("http://localhost:8080/multipartFormData")
String text(String name, Integer age, String email, @NotHttpParam String notMultiDataParam);
```