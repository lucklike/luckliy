##  ğŸ¤“ æå–æ ¹è·¯å¾„

---
åœ¨å®é™…å¼€å‘ä¸­ï¼ŒåŒä¸€ä¸ªä¸‰æ–¹å…¬å¸æä¾›çš„ä¸€ç³»åˆ—æ¥å£å¾€å¾€éƒ½æ‹¥æœ‰ç›¸åŒçš„åŸŸåï¼Œè¿™ä¸€ç±»çš„æ¥å£æˆ‘ä»¬éƒ½é€šå¸¸ä¼šå°è£…åˆ°åŒä¸€ä¸ªç±»ä¸­ã€‚
æŒ‰ç…§ä¹‹å‰çš„åšæ³•æˆ‘ä»¬éœ€è¦åœ¨æ¯ä¸ªæ¥å£æ–¹æ³•ä¸Šéƒ½å†™ä¸Šå®Œæ•´çš„URLï¼Œå½“å‰è¿™ç§åœºæ™¯ä¸‹è¿™ç§åšæ³•è‚¯å®šæ˜¯ä¸åˆç†çš„ï¼Œæ‰€ä»¥`lucky`
ä¸­æä¾›äº†`@DomainName`æ³¨è§£ç”¨äºæå–æ¥å£çš„å…¬å…±æ ¹è·¯å¾„ã€‚

---
### #ä½¿ç”¨`@DomainName`è®¾ç½®å›ºå®šæ ¹è·¯å¾„


ä»¥ç”¨æˆ·ä¿¡æ¯çš„ç³»åˆ—æ¥å£ä¸ºä¾‹ï¼š


- æ¥å£çš„åŸŸåä¸ºï¼š`localhost:8080`
- æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨çš„æ¥å£ï¼š`/user/list`
- è·å–å•ä¸ªç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯æ¥å£ï¼š`user/getOne?id=xxx`
- åˆ é™¤æŸä¸ªç”¨æˆ·æ¥å£ï¼š`user/delete?id=xxx`
- æ›´æ–°æŸä¸ªç”¨æˆ·ä¿¡æ¯çš„æ¥å£ï¼š`user/update`

```java
@DomainName("http://localhost:8080/user/")
public interface UserApi {

    /*
        æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨çš„æ¥å£
        getUserList()  -->  GET http://localhost:8080/user/list
     */
    @Get("/list")
    List<User> getUserList();

    /*
        è·å–å•ä¸ªç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯æ¥å£
        getUserInfo("u123")  -->  GET http://localhost:8080/user/getOne?id=u123
     */
    @Get("/getOne?id=#{p0}")
    User getUserInfo(String id);

    /*
        åˆ é™¤æŸä¸ªç”¨æˆ·æ¥å£
        deleteUser("u123")  -->  DELETE http://localhost:8080/user/delete?id=u123
     */
    @Delete("/delete?id=#{p0}")
    void deleteUser(String id);

    /*
        æ›´æ–°æŸä¸ªç”¨æˆ·ä¿¡æ¯çš„æ¥å£
        User user = new User();
        user.setId("u23");
        user.setName("Jack");
        user.setAge(23);
        updateUser(user);
        
        -->
        
        POST http://localhost:8864/user/post
        User-Agent: Lucky-HttpClient/3.0.0 (Java/1.8.0_301)
        Content-Type: application/json;charset=UTF-8
    
        {
          "id" : "u23",
          "name" : "Jack",
          "age" : 23,
        }
        
     */
    @Post("/update")
    void updateUser(@JsonBody User user);
}
```

---
### #ä½¿ç”¨`@DomainName`æ³¨è§£çš„`SpEL`åŠŸèƒ½æ¥è®¾ç½®åŠ¨æ€æ ¹åœ°å€
`@DomainName`é™¤äº†å¯ä»¥é…ç½®å›ºå®šæ ¹åœ°å€å¤–ï¼Œè¿˜æ”¯æŒåŠ¨æ€è·å–æ ¹åœ°å€ã€‚  
ä¾‹å¦‚ï¼šéœ€è¦åšä¸€ä¸ªç®€å•è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œæ¯æ¬¡è¯·æ±‚æ—¶éœ€è¦é€‰æ‹©é›†ç¾¤ä¸­çš„æŸä¸€å°æœºå™¨è¿›è¡Œè®¿é—®ã€‚  
é›†ç¾¤IPå¦‚ä¸‹ï¼Œæ¯æ¬¡è¯·æ±‚éœ€è¦åœ¨è¿™ä¸‰å°æœºå™¨ä¸Šè¿›è¡Œéšæœºé€‰æ‹©ï¼š  
- 192.168.0.1 
- 192.168.0.2, 
- 192.168.0.3,

```java
@DomainName("#{$this$.randomIpAcquisition()}")
public interface UserApi {
    
    //********æ¥å£æ–¹æ³•æ­¤å¤„çœç•¥************//
    
    /*
        1.åœ¨æ¥å£ä¸­å®šä¹‰ä¸€ä¸ªéšæœºè·å–IPåœ°å€çš„defaultæ–¹æ³• 
        2.åœ¨@DomainNameæ³¨è§£ä¸­ä½¿ç”¨SpELè¡¨è¾¾å¼è°ƒç”¨è¯¥æ–¹æ³• --> #{$this$.randomIpAcquisition()} 
     */
    default String randomIpAcquisition() {
        String[] ipArray = new String[] {
                "192.168.0.1",
                "192.168.0.2",
                "192.168.0.3",
        };
        // éšæœºé€‰å‡ºå…¶ä¸­ä¸€ä¸ª
        String randomIp = ipArray[new Random().nextInt(3)];
        return String.format("http://%s:8080/user", randomIp);
    }
}
```
è¯´æ˜ï¼š
- `SpELè¡¨è¾¾å¼`ï¼šSpELè¡¨è¾¾å¼éœ€è¦å†™åœ¨`#{}`ä¸­  
- `$this$`ï¼šå†…ç½®Rootå˜é‡ï¼Œè¡¨ç¤ºå½“å‰å¯¹è±¡å®ä¾‹
- `$this$.randomIpAcquisition()`ï¼šè¡¨ç¤ºè°ƒç”¨å½“å‰å¯¹è±¡å®ä¾‹`randomIpAcquisition()`æ–¹æ³•ï¼Œå°†æ–¹æ³•è¿”å›å€¼è®¾ç½®ä¸ºæ ¹åœ°å€

---
### #`@DomainName`è·å–ç¯å¢ƒå˜é‡ä¸­çš„æ ¹åœ°å€
âš ï¸æ³¨æ„ï¼šæ­¤ç§ç”¨æ³•åªèƒ½`Springç¯å¢ƒ`ä¸­ä½¿ç”¨

`application.yml`
```yaml
local:
  api:
    url: http://localhost:8080
```

1. ä½¿ç”¨`${}`è¡¨è¾¾å¼æ¥è·å–ç¯å¢ƒå˜é‡ä¸­çš„é…ç½®
```java
@DomainName("${local.api.url}/user")
public interface UserApi {

    //********æ¥å£æ–¹æ³•æ­¤å¤„çœç•¥************//
}
```

2. ä½¿ç”¨Springçš„`Environment`å¯¹è±¡æ¥è·å–ç¯å¢ƒå˜é‡ä¸­çš„é…ç½®

```java
import org.springframework.core.env.Environment;

@DomainName("#{@environment.getProperty('local.api.url')}/user")
public interface UserApi {

    //********æ¥å£æ–¹æ³•æ­¤å¤„çœç•¥************//
}
```
è¯´æ˜ï¼š  
- `@xxx`ï¼šè¡¨ç¤ºè·å–SpringIocå®¹å™¨ä¸­åç§°ä¸º`xxx`çš„Bean
- `@environment`ï¼šå³è¡¨ç¤ºè·å–è¡¨ç¤ºè·å–SpringIocå®¹å™¨ä¸­åç§°ä¸º`environment`çš„Beanï¼Œå³`Environment`å¯¹è±¡
- `@environment.getProperty('local.api.url')`ï¼šå³è°ƒç”¨`Environment`å¯¹è±¡çš„`getProperty()`æ–¹æ³•æ¥è·å–ç¯å¢ƒå˜é‡
